# Linting and code quality jobs

fmt:
  stage: lint
  image: rust:latest
  before_script:
    - rustup component add rustfmt
  script:
    - cargo fmt -- --check
  allow_failure: false

clippy:
  stage: lint
  image: rust:latest
  before_script:
    - rustup component add clippy
  script:
    - cargo clippy --all-features -- -D warnings -W clippy::pedantic
  allow_failure: false

clippy:pedantic:
  stage: lint
  image: rust:latest
  before_script:
    - rustup component add clippy
  script:
    - cargo clippy --all-features -- -W clippy::all -W clippy::pedantic -W clippy::nursery
  allow_failure: true

deny:
  stage: lint
  image: rust:latest
  before_script:
    - cargo install cargo-deny || true
  script:
    - cargo deny check licenses
    - cargo deny check bans
    - cargo deny check advisories
  allow_failure: false
